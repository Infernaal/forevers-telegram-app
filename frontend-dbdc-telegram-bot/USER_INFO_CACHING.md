# User Info Caching System

## Проблема
Ранее в компоненте `BottomNavigation` при каждом переключении вкладок происходил повторный вызов API `getUserInfo()`, что создавало ненужную нагрузку на сервер.

## Решение
Создан composable `useUserInfo.js` который реализует:

### 1. Кеширование данных
- Данные кешируются на 5 минут
- Повторные вызовы возвращают кешированные данные
- Избегаем множественных одновременных запросов

### 2. Периодическое обновление
- Автоматическое обновление данных каждые 5 минут
- Можно изменить интервал в константе `CACHE_DURATION`

### 3. Глобальное состояние
- Данные пользователя доступны во всех компонентах
- Избегаем дублирования запросов между компонентами

## Использование

### В компонентах:
```javascript
import { useUserInfo } from '../composables/useUserInfo.js'

export default {
  setup() {
    const { userInfo, getRankIcon, initializeUserInfo } = useUserInfo()
    
    // Инициализация при монтировании (если данных еще нет)
    onMounted(() => {
      initializeUserInfo()
    })
    
    return {
      userInfo,      // reactive объект с данными пользователя
      getRankIcon    // функция для получения иконки ранга
    }
  }
}
```

### Доступные методы:
- `userInfo` - реактивный объект с данными пользователя
- `isLoading` - состояние загрузки
- `fetchUserInfo(forceRefresh)` - ручной запрос данных
- `initializeUserInfo()` - инициализация с проверкой кеша
- `startPeriodicUpdate()` - запуск автообновления
- `stopPeriodicUpdate()` - остановка автообновления
- `getRankIcon(rank)` - получение иконки ранга
- `cleanup()` - очистка ресурсов

### Структура userInfo:
```javascript
{
  fullName: string,  // Полное имя пользователя
  rank: string,      // Ранг пользователя
  photo: string      // URL аватара
}
```

## Настройки

### Изменение интервала кеширования:
```javascript
const CACHE_DURATION = 10 * 60 * 1000 // 10 минут
```

### Принудительное обновление:
```javascript
const { fetchUserInfo } = useUserInfo()
await fetchUserInfo(true) // true = принудительное обновление
```

## Оптимизации

1. **Предварительная загрузка** - данные загружаются в `main.js` при старте приложения
2. **Умное кеширование** - проверка актуальности данных перед новым запросом  
3. **Защита от дублей** - предотвращение множественных одновременных запросов
4. **Автоочистка** - освобождение ресурсов при закрытии приложения

## Результат
- ✅ Сокращение API-запросов с N вызовов до 1 вызова в 5 минут
- ✅ Мгновенное отображение данных пользователя при переключении вкладок  
- ✅ Автоматическое обновление данных в фоне
- ✅ Единое место управления состоянием пользователя
